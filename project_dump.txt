
================================================================================
FILE: jsconfig.json
================================================================================

{
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": ["app/*"]
    }
  }
}

================================================================================
FILE: package.json
================================================================================

{
  "name": "fitnesstracker",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "eslint"
  },
  "dependencies": {
    "mongodb": "^6.20.0",
    "next": "^16.1.1",
    "react": "19.1.0",
    "react-dom": "19.1.0"
  },
  "devDependencies": {
    "@eslint/eslintrc": "^3",
    "@tailwindcss/postcss": "^4",
    "eslint": "^9",
    "eslint-config-next": "15.5.3",
    "tailwindcss": "^4"
  }
}

================================================================================
FILE: README.md
================================================================================

This is a [Next.js](https://nextjs.org) project bootstrapped with [`create-next-app`](https://github.com/vercel/next.js/tree/canary/packages/create-next-app).

## Getting Started

First, run the development server:

```bash
npm run dev
# or
yarn dev
# or
pnpm dev
# or
bun dev
```

Open [http://localhost:3000](http://localhost:3000) with your browser to see the result.

You can start editing the page by modifying `app/page.js`. The page auto-updates as you edit the file.

This project uses [`next/font`](https://nextjs.org/docs/app/building-your-application/optimizing/fonts) to automatically optimize and load [Geist](https://vercel.com/font), a new font family for Vercel.

## Learn More

To learn more about Next.js, take a look at the following resources:

- [Next.js Documentation](https://nextjs.org/docs) - learn about Next.js features and API.
- [Learn Next.js](https://nextjs.org/learn) - an interactive Next.js tutorial.

You can check out [the Next.js GitHub repository](https://github.com/vercel/next.js) - your feedback and contributions are welcome!

## Deploy on Vercel

The easiest way to deploy your Next.js app is to use the [Vercel Platform](https://vercel.com/new?utm_medium=default-template&filter=next.js&utm_source=create-next-app&utm_campaign=create-next-app-readme) from the creators of Next.js.

Check out our [Next.js deployment documentation](https://nextjs.org/docs/app/building-your-application/deploying) for more details.

================================================================================
FILE: app\globals.css
================================================================================

@import "tailwindcss";

:root {
  --background: #ffffff;
  --foreground: #171717;
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
}

@media (prefers-color-scheme: dark) {
  :root {
    --background: #0a0a0a;
    --foreground: #ededed;
  }
}

body {
  background: var(--background);
  color: var(--foreground);
  font-family: Arial, Helvetica, sans-serif;
}

================================================================================
FILE: app\layout.js
================================================================================

import { Geist, Geist_Mono } from "next/font/google";
import "./globals.css";

const geistSans = Geist({
  variable: "--font-geist-sans",
  subsets: ["latin"],
});

const geistMono = Geist_Mono({
  variable: "--font-geist-mono",
  subsets: ["latin"],
});

export const metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default function RootLayout({ children }) {
  return (
    <html lang="en">
      <body
        className={`${geistSans.variable} ${geistMono.variable} antialiased`}
      >
        {children}
      </body>
    </html>
  );
}



================================================================================
FILE: app\page.js
================================================================================

"use client";
import { useEffect, useMemo, useState } from "react";
import DaySection from "@/components/DaySection";
import Splash from "@/components/Splash";
import AudioPlayer from "@/components/AudioPlayer";
import data from "@/data/exercises.json";

// ISO week number (1-53) + year
function getWeekInfo(d = new Date()) {
  const date = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));
  const dayNum = (date.getUTCDay() + 6) % 7;
  date.setUTCDate(date.getUTCDate() - dayNum + 3);
  const firstThursday = new Date(Date.UTC(date.getUTCFullYear(), 0, 4));
  const week =
    1 +
    Math.round(
      ((date - firstThursday) / 86400000 -
        3 +
        ((firstThursday.getUTCDay() + 6) % 7)) /
        7
    );
  const year = date.getUTCFullYear();
  return { year, week, key: `${year}-W${week}` };
}

const ORDER = ["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];

export default function Page() {
  const [state, setState] = useState({ weights: {}, status: {} });
  const [showSplash, setShowSplash] = useState(true);
  const [openCard, setOpenCard] = useState(null); // single expanded card
  const { key: weekKey, week } = useMemo(() => getWeekInfo(), []);
  const days = useMemo(() => ORDER.map((d) => ({ name: d, items: data[d] || [] })), []);

  useEffect(() => {
    const t = setTimeout(() => setShowSplash(false), 1500);
    return () => clearTimeout(t);
  }, []);

  useEffect(() => {
    (async () => {
      try {
        const res = await fetch("/api/state", { cache: "no-store" });
        const s = await res.json();
        // weights are GLOBAL now
        setState({ weights: s.weights || {}, status: s.status || {} });
      } catch {}
    })();
  }, []);

  const updateStatus = async (day, idx, completed) => {
    setState((s) => ({
      ...s,
      status: {
        ...s.status,
        [weekKey]: {
          ...(s.status[weekKey] || {}),
          [day]: { ...((s.status[weekKey] || {})[day] || {}), [idx]: completed }
        }
      }
    }));
    await fetch("/api/complete", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ week: weekKey, day, key: idx, completed }),
    });
  };

  // Save weights globally (persist across weeks)
  const saveWeights = async (day, slug, weights) => {
    setState((s) => ({
      ...s,
      weights: {
        ...(s.weights || {}),
        [day]: {
          ...((s.weights || {})[day] || {}),
          [slug]: weights,
        },
      },
    }));
    await fetch("/api/weight", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ day, key: slug, weights }),
    });
  };

  const weekStatus = state.status[weekKey] || {};
  const globalWeights = state.weights || {};

  return (
    <div className="min-h-screen bg-slate-950 text-slate-100 relative">
      <Splash show={showSplash} />

      <main className="max-w-md mx-auto p-3 pb-20 space-y-6">
        <header className="sticky top-0 z-10 px-3 py-3 border-b border-slate-800 bg-slate-950/70 backdrop-blur">
          <h1 className="text-2xl font-extrabold tracking-tight">
            <span className="bg-gradient-to-r from-emerald-300 via-emerald-400 to-sky-400 bg-clip-text text-transparent">
              Andy &amp; Petronela
            </span>
          </h1>
          <p className="text-xs text-slate-400">Week W{week}</p>
        </header>

        {days.map(({ name, items }) => (
          <DaySection
            key={name}
            day={name}
            items={items}
            status={weekStatus[name] || {}}
            weights={globalWeights[name] || {}}
            onToggle={updateStatus}
            onSave={saveWeights}
            openCard={openCard}
            setOpenCard={setOpenCard}
          />
        ))}
      </main>

      <AudioPlayer />
    </div>
  );
}

================================================================================
FILE: app\api\audio\route.js
================================================================================

// app/api/audio/route.js
import { NextResponse } from "next/server";
import { readdir } from "fs/promises";
import path from "path";

export const runtime = "nodejs"; // ensure FS access

const AUDIO_EXTS = [".mp3", ".m4a", ".aac", ".ogg", ".wav", ".flac", ".webm"];

export async function GET() {
  try {
    const dir = path.join(process.cwd(), "public", "audio");
    const files = await readdir(dir);

    const tracks = files
      .filter((f) => AUDIO_EXTS.some((ext) => f.toLowerCase().endsWith(ext)))
      .map((f) => {
        const url = "/audio/" + encodeURIComponent(f);
        const base = f.replace(/\.[^/.]+$/, "");
        const display =
          decodeURIComponent(base)
            .replace(/[-_]+/g, " ")
            .replace(/\s+/g, " ")
            .trim() || f;
        return { name: display, url, file: f };
      })
      .sort((a, b) =>
        a.file.localeCompare(b.file, undefined, { sensitivity: "base" })
      );

    return NextResponse.json({ tracks });
  } catch (e) {
    return NextResponse.json({ tracks: [], error: String(e) }, { status: 200 });
  }
}

================================================================================
FILE: app\api\complete\route.js
================================================================================

import { NextResponse } from "next/server";
import { getCol } from "@/lib/mongo";

export const dynamic = "force-dynamic";

export async function POST(req) {
  try {
    const { week, day, key, completed } = await req.json();
    if (!week || !day || key === undefined)
      return NextResponse.json({ ok: false }, { status: 400 });

    const col = await getCol();
    const path = `status.${week}.${day}.${key}`;
    await col.updateOne(
      { _id: "status" },
      { $set: { [path]: !!completed } },
      { upsert: true }
    );

    return NextResponse.json({ ok: true });
  } catch (e) {
    return NextResponse.json(
      { ok: false, error: String(e?.message || e) },
      { status: 200 }
    );
  }
}

================================================================================
FILE: app\api\state\route.js
================================================================================

import { NextResponse } from "next/server";
import { getCol } from "@/lib/mongo";

export const dynamic = "force-dynamic"; // never prerender/cached

const DAYS = new Set([
  "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday",
]);

// Detect a key like "2025-W39"
function isWeekKey(k = "") {
  return /^\d{4}-W\d{1,2}$/.test(k);
}

// Sort week keys ascending by (year, week)
function sortWeekKeysAsc(keys = []) {
  return [...keys].sort((a, b) => {
    const [, ya, wa] = a.match(/^(\d{4})-W(\d{1,2})$/) || [];
    const [, yb, wb] = b.match(/^(\d{4})-W(\d{1,2})$/) || [];
    if (!ya || !yb) return a.localeCompare(b);
    const na = Number(ya) * 100 + Number(wa);
    const nb = Number(yb) * 100 + Number(wb);
    return na - nb;
  });
}

/**
 * Return:
 *  - status: unchanged (still per week)
 *  - weights: GLOBAL day/slug map
 *      If DB already holds global shape -> return as-is
 *      If DB still has old per-week shape -> collapse/merge latest-first
 */
export async function GET() {
  try {
    const col = await getCol();
    const docs = await col
      .find({ _id: { $in: ["status", "weights"] } })
      .toArray();

    const status = docs.find((d) => d._id === "status")?.status || {};
    const rawWeights = docs.find((d) => d._id === "weights")?.weights || {};

    let weights = {};

    // Case 1: Already global (days at top level)
    const topKeys = Object.keys(rawWeights || {});
    const looksGlobal = topKeys.some((k) => DAYS.has(k));

    if (looksGlobal) {
      weights = rawWeights || {};
    } else {
      // Case 2: Legacy per-week: collapse to global
      // Strategy: iterate weeks ascending and let later weeks override earlier ones
      const weekKeys = topKeys.filter(isWeekKey);
      if (weekKeys.length) {
        const ordered = sortWeekKeysAsc(weekKeys);
        const merged = {};
        for (const wk of ordered) {
          const byDay = rawWeights[wk] || {};
          for (const day of Object.keys(byDay)) {
            merged[day] = {
              ...(merged[day] || {}),
              ...(byDay[day] || {}),
            };
          }
        }
        weights = merged;
      } else {
        // Fallback: nothing recognizable -> keep empty object
        weights = {};
      }
    }

    return NextResponse.json({ status, weights });
  } catch (e) {
    return NextResponse.json(
      { status: {}, weights: {}, error: String(e?.message || e) },
      { status: 200 }
    );
  }
}

================================================================================
FILE: app\api\weight\route.js
================================================================================

import { NextResponse } from "next/server";
import { getCol } from "@/lib/mongo";

export const dynamic = "force-dynamic";

/**
 * Save weights GLOBALLY (not per week).
 * Body: { day, key, weights: { Andy, Petronela } }
 * Mongo shape:
 *   _id: "weights"
 *   weights: {
 *     [day]: {
 *       [slug]: { Andy: "20", Petronela: "10" }
 *     }
 *   }
 */
export async function POST(req) {
  try {
    const { day, key, weights } = await req.json();
    if (!day || !key || !weights) {
      return NextResponse.json({ ok: false, error: "Missing fields" }, { status: 400 });
    }

    const clean = (v) => String(v ?? "").replace(/[^\d.]/g, "");
    const payload = {
      Andy: clean(weights.Andy),
      Petronela: clean(weights.Petronela),
    };

    const col = await getCol();
    // â¬‡ï¸ No week in the path anymore
    const path = `weights.${day}.${key}`;
    await col.updateOne(
      { _id: "weights" },
      { $set: { [path]: payload } },
      { upsert: true }
    );

    return NextResponse.json({ ok: true });
  } catch (e) {
    return NextResponse.json(
      { ok: false, error: String(e?.message || e) },
      { status: 200 }
    );
  }
}

================================================================================
FILE: app\components\AudioPlayer.js
================================================================================

"use client";
import { useEffect, useRef, useState } from "react";

export default function AudioPlayer() {
  const audioRef = useRef(null);
  const [ready, setReady] = useState(false);
  const [playing, setPlaying] = useState(false);
  const [t, setT] = useState({ cur: 0, dur: 0 }); // seconds

  const [tracks, setTracks] = useState([]); // {name, url, file}[]
  const [current, setCurrent] = useState(null); // track object
  const [menuOpen, setMenuOpen] = useState(false);

  // Fetch tracks from /api/audio
  useEffect(() => {
    let alive = true;
    (async () => {
      try {
        const res = await fetch("/api/audio", { cache: "no-store" });
        const data = await res.json();
        if (!alive) return;
        const list = data?.tracks || [];
        setTracks(list);

        // Choose default: last chosen from localStorage, else first alphabetically
        const last =
          typeof window !== "undefined"
            ? localStorage.getItem("audio:selected")
            : null;
        const found = list.find((x) => x.url === last);
        setCurrent(found || list[0] || null);
      } catch {
        setTracks([]);
        setCurrent(null);
      }
    })();
    return () => {
      alive = false;
    };
  }, []);

  // Create/reuse a single <audio> element; update source when `current` changes.
  useEffect(() => {
    // if no track yet, donâ€™t create audio
    if (!current) return;

    let el = audioRef.current;
    const fresh = !el;

    if (!el) {
      el = new Audio();
      el.preload = "metadata";
      el.loop = true; // ðŸ” ensure it always loops when it reaches the end
      audioRef.current = el;

      const onLoaded = () => setT((s) => ({ ...s, dur: el.duration || 0 }));
      const onTime = () =>
        setT({ cur: el.currentTime || 0, dur: el.duration || 0 });
      const onEnd = () => setPlaying(false);

      el.addEventListener("loadedmetadata", onLoaded);
      el.addEventListener("timeupdate", onTime);
      el.addEventListener("ended", onEnd);
      setReady(true);
    }

    // update source (preserve play/pause state)
    const shouldResume = playing;
    el.src = current.url;
    el.load();

    // Update Media Session
    if ("mediaSession" in navigator) {
      navigator.mediaSession.metadata = new window.MediaMetadata({
        title: current.name || "Audio",
        artist: "Playlist",
        album: "Workout",
      });
      navigator.mediaSession.setActionHandler?.("play", () => play());
      navigator.mediaSession.setActionHandler?.("pause", () => pause());
      navigator.mediaSession.setActionHandler?.("seekto", (d) => {
        if (el && typeof d.seekTime === "number") el.currentTime = d.seekTime;
      });
      navigator.mediaSession.setActionHandler?.("previoustrack", prev);
      navigator.mediaSession.setActionHandler?.("nexttrack", next);
    }

    // restore playback if we were playing
    if (!fresh && shouldResume) {
      el.play().catch(() => {});
    } else {
      setPlaying(false);
      setT({ cur: 0, dur: 0 });
    }

    // persist selection
    try {
      localStorage.setItem("audio:selected", current.url);
    } catch {}

    // cleanup on unmount handled in a separate effect if needed
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [current]);

  useEffect(() => {
    return () => {
      const el = audioRef.current;
      if (!el) return;
      el.pause();
      el.src = "";
      el.load();
      audioRef.current = null;
    };
  }, []);

  const play = async () => {
    try {
      await audioRef.current?.play();
      setPlaying(true);
    } catch (err) {
      // requires user gesture, button press counts
      console.error(err);
    }
  };
  const pause = () => {
    audioRef.current?.pause();
    setPlaying(false);
  };
  const toggle = () => (playing ? pause() : play());

  const onScrub = (e) => {
    const val = Number(e.target.value);
    if (!audioRef.current) return;
    audioRef.current.currentTime = val;
    setT((s) => ({ ...s, cur: val }));
  };

  // Track navigation
  const indexOf = (trk) => tracks.findIndex((x) => x.url === trk?.url);
  const prev = () => {
    if (!current || !tracks.length) return;
    const i = indexOf(current);
    const n = (i - 1 + tracks.length) % tracks.length;
    setCurrent(tracks[n]);
  };
  const next = () => {
    if (!current || !tracks.length) return;
    const i = indexOf(current);
    const n = (i + 1) % tracks.length;
    setCurrent(tracks[n]);
  };

  const fmt = (s) => {
    const m = Math.floor((s || 0) / 60);
    const sec = Math.floor((s || 0) % 60)
      .toString()
      .padStart(2, "0");
    return `${m}:${sec}`;
  };

  const pick = (trk) => {
    setMenuOpen(false);
    setCurrent(trk);
    // if we were playing, resume automatically on the new track
    if (playing) {
      // slight delay so the new src is set
      setTimeout(() => play(), 0);
    }
  };

  return (
    <div className="fixed right-3 bottom-3 z-40">
      {/* Mini player card */}
      <div className="relative rounded-2xl border border-slate-800/70 bg-slate-900/70 backdrop-blur px-3 py-2 shadow-xl w-72">
        <div className="flex items-center gap-2">
          {/* Play / Pause */}
          <button
            onClick={toggle}
            disabled={!ready || !current}
            className={[
              "h-10 w-10 rounded-full border flex items-center justify-center",
              "border-slate-700 bg-slate-800/70 active:scale-95 transition",
              ready ? "text-white" : "text-slate-500",
            ].join(" ")}
            aria-label={playing ? "Pause" : "Play"}
            title={playing ? "Pause" : "Play"}
          >
            {playing ? (
              <svg viewBox="0 0 24 24" className="h-5 w-5">
                <path fill="currentColor" d="M6 5h4v14H6zM14 5h4v14h-4z" />
              </svg>
            ) : (
              <svg viewBox="0 0 24 24" className="h-5 w-5">
                <path fill="currentColor" d="M8 5v14l11-7z" />
              </svg>
            )}
          </button>

          {/* Track info + scrubber */}
          <div className="flex-1 min-w-0">
            <div className="text-xs text-slate-300 truncate">
              {current ? current.name : "No audio found"}
            </div>
            <div className="flex items-center gap-2">
              <input
                type="range"
                min={0}
                max={t.dur || 0}
                step="1"
                value={t.cur}
                onChange={onScrub}
                disabled={!current}
                className="w-full accent-emerald-500"
              />
            </div>
            <div className="flex justify-between text-[10px] text-slate-400">
              <span>{fmt(t.cur)}</span>
              <span>{fmt(t.dur || 0)}</span>
            </div>
          </div>

          {/* Track menu toggle */}
          <button
            onClick={() => setMenuOpen((v) => !v)}
            disabled={!tracks.length}
            className="h-10 w-10 rounded-full border border-slate-700 bg-slate-800/70 text-white active:scale-95 transition grid place-items-center"
            aria-label="Choose track"
            title="Choose track"
          >
            {/* music note icon */}
            <svg viewBox="0 0 24 24" className="h-5 w-5">
              <path
                fill="currentColor"
                d="M12 3v10.55A4 4 0 1 1 10 9V5h8V3h-6z"
              />
            </svg>
          </button>
        </div>

        {/* Dropdown menu */}
        {menuOpen && (
          <div className="absolute right-0 bottom-14 w-72 max-h-64 overflow-auto rounded-xl border border-slate-800 bg-slate-900/90 backdrop-blur shadow-2xl">
            {tracks.length ? (
              <ul className="py-1">
                {tracks.map((trk) => {
                  const active = current && trk.url === current.url;
                  return (
                    <li key={trk.url}>
                      <button
                        onClick={() => pick(trk)}
                        className={[
                          "w-full text-left px-3 py-2 text-sm flex items-center gap-2",
                          active
                            ? "bg-emerald-600/20 text-emerald-200"
                            : "text-slate-200 hover:bg-slate-800/60",
                        ].join(" ")}
                      >
                        {active ? (
                          <svg viewBox="0 0 24 24" className="h-4 w-4">
                            <path
                              fill="currentColor"
                              d="M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"
                            />
                          </svg>
                        ) : (
                          <svg
                            viewBox="0 0 24 24"
                            className="h-4 w-4 opacity-50"
                          >
                            <path
                              fill="currentColor"
                              d="M12 3v10.55A4 4 0 1 1 10 9V5h8V3h-6z"
                            />
                          </svg>
                        )}
                        <span className="truncate">{trk.name}</span>
                      </button>
                    </li>
                  );
                })}
              </ul>
            ) : (
              <div className="px-3 py-2 text-sm text-slate-400">
                No audio files
              </div>
            )}
          </div>
        )}
      </div>
    </div>
  );
}

================================================================================
FILE: app\components\ConfettiCanvas.js
================================================================================

//components/ConfettiCanvas.js
"use client";
import { useEffect, useRef } from "react";

export default function ConfettiCanvas({ duration = 1800, count = 120 }) {
  const ref = useRef(null);

  useEffect(() => {
    const canvas = ref.current;
    if (!canvas) return;
    const ctx = canvas.getContext("2d");
    let w = (canvas.width = canvas.offsetWidth);
    let h = (canvas.height = 180);
    const colors = [
      "#34d399",
      "#60a5fa",
      "#f472b6",
      "#fbbf24",
      "#22d3ee",
      "#a78bfa",
    ];
    const rand = (min, max) => Math.random() * (max - min) + min;

    const parts = Array.from({ length: count }).map(() => ({
      x: rand(0, w),
      y: rand(-h, 0),
      vx: rand(-0.8, 0.8),
      vy: rand(1.2, 2.6),
      size: rand(2, 4),
      color: colors[(Math.random() * colors.length) | 0],
      rot: rand(0, 2 * Math.PI),
      vr: rand(-0.15, 0.15),
    }));

    let start = performance.now();
    let raf;
    const draw = (t) => {
      const elapsed = t - start;
      ctx.clearRect(0, 0, w, h);
      parts.forEach((p) => {
        p.x += p.vx;
        p.y += p.vy;
        p.rot += p.vr;
        if (p.y > h) {
          p.y = -10;
          p.x = rand(0, w);
        }
        ctx.save();
        ctx.translate(p.x, p.y);
        ctx.rotate(p.rot);
        ctx.fillStyle = p.color;
        ctx.fillRect(-p.size / 2, -p.size / 2, p.size, p.size);
        ctx.restore();
      });
      if (elapsed < duration) raf = requestAnimationFrame(draw);
    };
    raf = requestAnimationFrame(draw);
    const onResize = () => {
      w = canvas.width = canvas.offsetWidth;
    };
    window.addEventListener("resize", onResize);
    return () => {
      cancelAnimationFrame(raf);
      window.removeEventListener("resize", onResize);
    };
  }, [count, duration]);

  return (
    <canvas ref={ref} className="w-full h-[180px] rounded-lg bg-transparent" />
  );
}

================================================================================
FILE: app\components\DaySection.js
================================================================================

"use client";
import ExerciseCard from "./ExerciseCard";
import Modal from "./Modal";
import { useMemo, useState } from "react";

function slugify(title = "") {
  return title
    .toLowerCase()
    .replace(/[^a-z0-9]+/g, "-")
    .replace(/(^-|-$)/g, "");
}

const GROUPS = {
  Wednesday: "Chest & Triceps",
  Thursday: "Back & Biceps",
  Friday: "Shoulders",
  Saturday: "Full Body / Core",
  Sunday: "Legs",
};

export default function DaySection({
  day,
  items,
  status,
  weights,
  onToggle,
  onSave,
  openCard, // ðŸ‘ˆ from page
  setOpenCard, // ðŸ‘ˆ from page
}) {
  const isRest = day === "Monday" || day === "Tuesday";
  const [celebrate, setCelebrate] = useState(false);

  // Count ALL items (warmup included)
  const counts = useMemo(() => {
    const total = items?.length || 0;
    const done = Object.values(status || {}).filter(Boolean).length;
    return { done, total };
  }, [items, status]);

  const handleToggle = async (idx, v) => {
    const next = { ...(status || {}) };
    next[idx] = v;
    const total = items?.length || 0;
    const done = Object.values(next).filter(Boolean).length;
    if (done >= total && total > 0) setCelebrate(true);
    await onToggle(day, idx, v);
  };

  return (
    <section className="scroll-mt-16">
      {/* Glassy section header */}
      <div className="relative rounded-3xl border border-slate-800/70 bg-slate-900/50 backdrop-blur shadow-xl p-4">
        <div className="pointer-events-none absolute top-0 left-0 h-px w-full bg-gradient-to-r from-emerald-500/40 via-sky-500/30 to-transparent" />

        <header className="flex items-center justify-between gap-3">
          <div className="flex items-center gap-2">
            <span className="inline-block w-2 h-2 rounded-full bg-emerald-400/70" />
            <h2 className="text-base font-semibold text-white">{day}</h2>
            {GROUPS[day] && (
              <span className="text-[11px] px-2 py-1 rounded-full border border-slate-700/70 text-slate-300 bg-slate-900/50 backdrop-blur">
                {GROUPS[day]}
              </span>
            )}
          </div>

          {!isRest && (
            <div className="text-[11px] text-slate-300 flex items-center gap-2">
              <div className="h-1.5 w-16 rounded-full bg-slate-800 overflow-hidden">
                <div
                  className="h-full bg-gradient-to-r from-emerald-500 via-emerald-400 to-sky-400 transition-all"
                  style={{
                    width:
                      counts.total > 0
                        ? `${Math.min(
                            100,
                            Math.round((counts.done / counts.total) * 100)
                          )}%`
                        : "0%",
                  }}
                />
              </div>
              <span className="tabular-nums">
                {counts.done}/{counts.total}
              </span>
            </div>
          )}
        </header>

        <div className="mt-3 space-y-3">
          {isRest ? (
            <p className="text-sm text-slate-300/90 border border-slate-800/80 rounded-2xl p-4 bg-slate-900/50 backdrop-blur shadow-inner">
              Rest day ðŸ˜Œ
            </p>
          ) : (
            (items || []).map((ex, i) => {
              const id = `${day}-${i}`; // ðŸ‘ˆ unique per card across the app
              const key = slugify(ex.title);
              const w = (weights && (weights[key] || weights[i])) || {
                Andy: "",
                Petronela: "",
              };

              return (
                <ExerciseCard
                  key={id}
                  id={id} // ðŸ‘ˆ pass id
                  isOpen={openCard === id} // ðŸ‘ˆ controlled open
                  setOpenCard={setOpenCard} // ðŸ‘ˆ so card can request open/close
                  day={day}
                  index={i}
                  exercise={ex}
                  completed={!!status[i]}
                  weights={w}
                  onToggle={(v) => handleToggle(i, v)}
                  onSave={(payload) => onSave(day, key, payload)}
                />
              );
            })
          )}
        </div>
      </div>

      {celebrate && (
        <Modal onClose={() => setCelebrate(false)} title={`${day} complete`}>
          <div className="space-y-4">
            <div className="flex items-center gap-3">
              <div className="h-9 w-9 rounded-xl bg-emerald-600/20 border border-emerald-500/30 grid place-items-center">
                <svg viewBox="0 0 24 24" className="h-5 w-5 text-emerald-300">
                  <path
                    fill="currentColor"
                    d="M9.55 17.05 4.5 12l1.4-1.4 3.65 3.6 8.1-8.1L19 7.5 9.55 17.05z"
                  />
                </svg>
              </div>
              <div>
                <p className="text-sm text-slate-200">
                  Everything for {day} is done.
                </p>
                <p className="text-xs text-slate-400">
                  Great paceâ€”see you tomorrow.
                </p>
              </div>
            </div>
            <button
              onClick={() => setCelebrate(false)}
              className="w-full rounded-xl bg-gradient-to-r from-emerald-600 via-emerald-500 to-sky-500 text-white py-2 text-sm font-medium"
            >
              Continue
            </button>
          </div>
        </Modal>
      )}
    </section>
  );
}

================================================================================
FILE: app\components\ExerciseCard.js
================================================================================

"use client";
import { useEffect, useRef, useState, useMemo } from "react";
import Modal from "./Modal";

function Check({ checked, onChange }) {
  const toggle = () => onChange(!checked);
  const onKey = (e) => {
    if (e.key === " " || e.key === "Enter") {
      e.preventDefault();
      toggle();
    }
  };
  return (
    <button
      type="button"
      role="checkbox"
      aria-checked={checked}
      onClick={toggle}
      onKeyDown={onKey}
      className={[
        "h-5 w-5 rounded-md border transition-all duration-200 ease-in-out",
        checked
          ? "bg-emerald-600 border-emerald-500 shadow-[0_0_0_4px_rgba(16,185,129,0.15)] scale-95"
          : "bg-slate-800/80 border-slate-700 hover:border-slate-600",
      ].join(" ")}
    >
      <svg
        viewBox="0 0 24 24"
        className={[
          "mx-auto h-3 w-3 text-white transition-transform duration-200 ease-in-out",
          checked ? "scale-100" : "scale-0",
        ].join(" ")}
        aria-hidden="true"
      >
        <path
          fill="currentColor"
          d="M20.285 6.709a1 1 0 0 0-1.414-1.418l-8.5 8.51-3.242-3.243a1 1 0 1 0-1.415 1.414l3.95 3.95a1 1 0 0 0 1.415 0l9.206-9.213z"
        />
      </svg>
    </button>
  );
}

export default function ExerciseCard({
  id, // ðŸ‘ˆ added
  isOpen, // ðŸ‘ˆ added (controlled open from parent)
  setOpenCard, // ðŸ‘ˆ added (setter from parent)
  day,
  index,
  exercise,
  completed,
  weights,
  onToggle,
  onSave,
}) {
  // (removed local `open` state; now controlled via isOpen)
  const [local, setLocal] = useState(weights);
  const [saved, setSaved] = useState(false);
  const [growthMsg, setGrowthMsg] = useState("");

  // --- Video playback state ---
  const [isPlaying, setIsPlaying] = useState(false);

  // --- Fullscreen state/refs ---
  const videoRef = useRef(null);
  const containerRef = useRef(null);
  const [isFullscreen, setIsFullscreen] = useState(false);

  // --- Double tap detection ---
  const lastTapRef = useRef(0);

  // --- Mute state ---
  const [isMuted, setIsMuted] = useState(true); // Start muted by default

  useEffect(() => {
    setLocal(weights || { Andy: "", Petronela: "" });
  }, [weights]);

  const sanitize = (v) => String(v ?? "").replace(/[^\d.]/g, "");
  const num = (v) => (v === "" || v == null ? 0 : parseFloat(v));
  const src = `/videos/${(exercise.video || exercise.title).trim()}.mp4`;

  const chips = useMemo(() => {
    const a = weights?.Andy ? `${weights.Andy}kg` : "â€”";
    const p = weights?.Petronela ? `${weights.Petronela}kg` : "â€”";
    return { a, p };
  }, [weights]);

  const save = async () => {
    const prevA = num(weights.Andy);
    const prevP = num(weights.Petronela);
    const nextA = num(sanitize(local.Andy));
    const nextP = num(sanitize(local.Petronela));
    const ups = [];
    if (nextA > prevA) ups.push(`Andy +${(nextA - prevA).toFixed(0)} kg`);
    if (nextP > prevP) ups.push(`Petronela +${(nextP - prevP).toFixed(0)} kg`);

    setSaved(false);
    await onSave({
      Andy: sanitize(local.Andy),
      Petronela: sanitize(local.Petronela),
    });
    setSaved(true);
    setTimeout(() => setSaved(false), 1000);
    if (ups.length) setGrowthMsg(ups.join("\n"));
  };

  // --- Toggle play/pause function ---
  const togglePlayPause = (e) => {
    e.stopPropagation(); // Prevent other click handlers
    const vid = videoRef.current;
    if (vid) {
      if (vid.paused) {
        vid.play();
        setIsPlaying(true);
      } else {
        vid.pause();
        setIsPlaying(false);
      }
    }
  };

  // --- Handle video tap (single tap = play/pause, double tap = fullscreen) ---
  const handleVideoTap = (e) => {
    e.stopPropagation();
    const currentTime = new Date().getTime();
    const tapLength = currentTime - lastTapRef.current;

    if (tapLength < 300 && tapLength > 0) {
      // Double tap detected - toggle fullscreen
      if (isFullscreen || document.fullscreenElement) {
        exitFullscreen();
      } else {
        enterFullscreen();
      }
    } else {
      // Single tap - toggle play/pause
      togglePlayPause(e);
    }

    lastTapRef.current = currentTime;
  };

  // --- Toggle mute function ---
  const toggleMute = (e) => {
    e.stopPropagation(); // Prevent other click handlers
    const vid = videoRef.current;
    if (vid) {
      vid.muted = !vid.muted;
      setIsMuted(vid.muted);
    }
  };

  // --- Handle card expand/collapse (controlled) ---
  const handleToggleOpen = () => {
    if (isOpen) {
      setOpenCard(null); // close if this one is open
    } else {
      setOpenCard(id); // open this and implicitly close others
    }

    const vid = videoRef.current;
    if (vid) {
      if (!isOpen) {
        // being opened
        vid.play();
        setIsPlaying(true);
      } else {
        // being closed
        vid.pause();
        setIsPlaying(false);
      }
    }
  };

  // --- Sync video state when open changes ---
  useEffect(() => {
    const vid = videoRef.current;
    if (vid) {
      if (isOpen) {
        vid.play();
        setIsPlaying(true);
      } else {
        vid.pause();
        setIsPlaying(false);
      }
    }
  }, [isOpen]);

  // --- Sync muted state with video element ---
  useEffect(() => {
    const vid = videoRef.current;
    if (vid) {
      vid.muted = isMuted;
    }
  }, [isMuted]);

  // --- Listen for video play/pause events ---
  useEffect(() => {
    const vid = videoRef.current;
    if (!vid) return;

    const onPlay = () => setIsPlaying(true);
    const onPause = () => setIsPlaying(false);

    vid.addEventListener("play", onPlay);
    vid.addEventListener("pause", onPause);

    return () => {
      vid.removeEventListener("play", onPlay);
      vid.removeEventListener("pause", onPause);
    };
  }, []);

  // --- Fullscreen helpers (desktop + iOS/Android) ---
  const enterFullscreen = async () => {
    const vid = videoRef.current;
    const box = containerRef.current;
    if (!vid) return;

    try {
      // iOS Safari prefers video.webkitEnterFullscreen()
      if (typeof vid.webkitEnterFullscreen === "function") {
        vid.webkitEnterFullscreen();
        setIsFullscreen(true);
        return;
      }
      // Standard Fullscreen API (prefer container so overlay button hides)
      if (box?.requestFullscreen) {
        await box.requestFullscreen({ navigationUI: "hide" });
        setIsFullscreen(true);
        return;
      }
      if (vid.requestFullscreen) {
        await vid.requestFullscreen();
        setIsFullscreen(true);
        return;
      }
    } catch (e) {
      console.error("Fullscreen error:", e);
    }
  };

  const exitFullscreen = async () => {
    const vid = videoRef.current;
    // iOS Safari
    if (
      vid &&
      typeof vid.webkitExitFullscreen === "function" &&
      vid.webkitDisplayingFullscreen
    ) {
      try {
        vid.webkitExitFullscreen();
      } catch {}
      setIsFullscreen(false);
      return;
    }
    // Standard
    if (document.fullscreenElement) {
      try {
        await document.exitFullscreen();
      } catch {}
      setIsFullscreen(false);
    }
  };

  const toggleFullscreen = (e) => {
    e.stopPropagation(); // Prevent other click handlers
    if (isFullscreen || document.fullscreenElement) exitFullscreen();
    else enterFullscreen();
  };

  // Track fullscreen changes (standard + iOS webkit events)
  useEffect(() => {
    const onChange = () => setIsFullscreen(Boolean(document.fullscreenElement));
    document.addEventListener("fullscreenchange", onChange);
    const vid = videoRef.current;
    const onWebkitBegin = () => setIsFullscreen(true);
    const onWebkitEnd = () => setIsFullscreen(false);
    if (vid) {
      vid.addEventListener("webkitbeginfullscreen", onWebkitBegin);
      vid.addEventListener("webkitendfullscreen", onWebkitEnd);
    }
    return () => {
      document.removeEventListener("fullscreenchange", onChange);
      if (vid) {
        vid.removeEventListener("webkitbeginfullscreen", onWebkitBegin);
        vid.removeEventListener("webkitendfullscreen", onWebkitEnd);
      }
    };
  }, []);

  // Apply different styles based on fullscreen state
  useEffect(() => {
    const vid = videoRef.current;
    if (!vid) return;

    if (isFullscreen) {
      // In fullscreen, make video fill the entire screen
      vid.style.width = "100vw";
      vid.style.height = "100vh";
      vid.style.objectFit = "contain"; // or 'cover' if you want to fill completely
      vid.style.position = "fixed";
      vid.style.top = "0";
      vid.style.left = "0";
      vid.style.zIndex = "9999";
    } else {
      // Reset to normal styles when exiting fullscreen
      vid.style.width = "";
      vid.style.height = "";
      vid.style.objectFit = "";
      vid.style.position = "";
      vid.style.top = "";
      vid.style.left = "";
      vid.style.zIndex = "";
    }
  }, [isFullscreen]);

  // Gradient shell for glass border
  const shell = completed
    ? "from-emerald-600/50 via-emerald-500/25 to-sky-500/25"
    : "from-slate-700/60 via-emerald-600/25 to-sky-600/25";

  return (
    <div className={["rounded-2xl p-[1px] bg-gradient-to-r", shell].join(" ")}>
      <article
        className={[
          "rounded-[1rem] border border-slate-800/70 bg-slate-900/60 backdrop-blur shadow-lg transition-transform",
          "hover:-translate-y-[1px] active:translate-y-0",
        ].join(" ")}
      >
        {/* Collapsed header */}
        <header className="flex items-center gap-3 px-4 py-3">
          <Check checked={completed} onChange={(v) => onToggle(v)} />

          <button onClick={handleToggleOpen} className="flex-1 text-left">
            <div className="flex items-center gap-2">
              <span className="text-[10px] px-2 py-0.5 rounded-full border border-slate-700 text-slate-300 bg-slate-900/60">
                {index === 0 ? "Warmup" : `#${index}`}
              </span>
              <h3 className="text-[15px] font-semibold leading-tight text-white">
                {exercise.title}
              </h3>
            </div>
            <p className="text-[11px] text-slate-400">
              Tap to {isOpen ? "collapse" : "expand"}
            </p>
          </button>

          <div className="flex items-center gap-2">
            <span
              className={[
                "text-[10px] px-2 py-1 rounded-full border",
                completed
                  ? "border-emerald-500 text-emerald-300"
                  : "border-slate-700 text-slate-400",
              ].join(" ")}
            >
              {completed ? "Done" : "Pending"}
            </span>
            <svg
              viewBox="0 0 24 24"
              className={[
                "h-4 w-4 text-slate-400 transition-transform duration-300 ease-in-out",
                isOpen ? "rotate-180" : "rotate-0",
              ].join(" ")}
            >
              <path
                fill="currentColor"
                d="M7.41 8.58 12 13.17l4.59-4.59L18 10l-6 6-6-6z"
              />
            </svg>
          </div>
        </header>

        {/* Expanded body */}
        <div
          className={[
            "grid transition-all duration-300 ease-in-out",
            isOpen
              ? "grid-rows-[1fr] opacity-100"
              : "grid-rows-[0fr] opacity-0",
          ].join(" ")}
        >
          <div className="overflow-hidden">
            <div className="px-4 pb-4 space-y-4">
              <p className="text-sm text-slate-300">{exercise.description}</p>

              {/* Inputs */}
              <div className="grid grid-cols-2 gap-2 text-sm">
                <label className="flex flex-col gap-1">
                  <span className="text-xs text-slate-400">Andy (kg)</span>
                  <input
                    inputMode="decimal"
                    className="w-full rounded-lg bg-slate-950/70 border border-slate-800 px-3 py-2
                  focus:outline-none focus:ring-1 focus:ring-emerald-500
                  text-white placeholder:text-slate-600 text-[16px] leading-6"
                    value={local.Andy}
                    onChange={(e) =>
                      setLocal((s) => ({ ...s, Andy: e.target.value }))
                    }
                    placeholder="â€”"
                  />
                </label>
                <label className="flex flex-col gap-1">
                  <span className="text-xs text-slate-400">Petronela (kg)</span>
                  <input
                    inputMode="decimal"
                    className="w-full rounded-lg bg-slate-950/70 border border-slate-800 px-3 py-2
                  focus:outline-none focus:ring-1 focus:ring-emerald-500
                  text-white placeholder:text-slate-600 text-[16px] leading-6"
                    value={local.Petronela}
                    onChange={(e) =>
                      setLocal((s) => ({ ...s, Petronela: e.target.value }))
                    }
                    placeholder="â€”"
                  />
                </label>
              </div>

              {/* Save */}
              <button
                onClick={save}
                className="w-full rounded-xl bg-gradient-to-r from-emerald-600 via-emerald-500 to-sky-500 text-white py-2 text-sm font-medium active:scale-[.99] transition"
              >
                {saved ? "Saved âœ“" : "Save"}
              </button>

              {/* Media with video controls */}
              <div
                ref={containerRef}
                className="relative overflow-hidden rounded-2xl border border-slate-800"
              >
                <video
                  ref={videoRef}
                  src={src}
                  loop
                  muted
                  playsInline
                  onClick={handleVideoTap}
                  className="w-full h-48 object-cover bg-black cursor-pointer"
                />

                {/* Play/Pause indicator */}
                <div
                  className={[
                    "absolute left-2 bottom-2 rounded-lg border border-slate-700/70 bg-slate-900/70 backdrop-blur px-2 py-1 transition-opacity duration-300",
                    !isPlaying ? "opacity-100" : "opacity-0",
                  ].join(" ")}
                >
                  <svg viewBox="0 0 24 24" className="h-4 w-4 text-slate-200">
                    <path fill="currentColor" d="M8 5v14l11-7z" />
                  </svg>
                </div>

                {/* Volume control button */}
                <button
                  type="button"
                  onClick={toggleMute}
                  className="absolute left-2 top-2 rounded-lg border border-slate-700/70 bg-slate-900/70 backdrop-blur px-2 py-1 text-[11px] text-slate-200 hover:border-slate-600 active:scale-95 transition"
                  aria-label={isMuted ? "Unmute" : "Mute"}
                >
                  {isMuted ? (
                    // Muted icon
                    <svg viewBox="0 0 24 24" className="h-4 w-4">
                      <path
                        fill="currentColor"
                        d="M16.5 12A4.5 4.5 0 0 0 14 7.97v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51A8.796 8.796 0 0 0 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06a8.99 8.99 0 0 0 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"
                      />
                    </svg>
                  ) : (
                    // Unmuted icon
                    <svg viewBox="0 0 24 24" className="h-4 w-4">
                      <path
                        fill="currentColor"
                        d="M3 9v6h4l5 5V4L7 9H3zm13.5 3A4.5 4.5 0 0 0 14 7.97v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"
                      />
                    </svg>
                  )}
                </button>

                {/* Helper text for exiting fullscreen */}
                {isFullscreen && (
                  <div
                    className="absolute bottom-4 left-1/2 -translate-x-1/2 rounded-lg bg-black/50 px-3 py-1 text-sm text-white pointer-events-none transition-opacity duration-300"
                    style={{ zIndex: 10000 }}
                  >
                    Double tap to exit
                  </div>
                )}

                {/* Fullscreen toggle button (Normal view) */}
                <button
                  type="button"
                  onClick={toggleFullscreen}
                  className="absolute right-2 top-2 rounded-lg border border-slate-700/70 bg-slate-900/70 backdrop-blur px-2 py-1 text-[11px] text-slate-200 hover:border-slate-600 active:scale-95 transition"
                  aria-label={
                    isFullscreen ? "Exit fullscreen" : "Enter fullscreen"
                  }
                >
                  {isFullscreen ? (
                    // exit icon
                    <svg viewBox="0 0 24 24" className="h-4 w-4">
                      <path
                        fill="currentColor"
                        d="M7 14H5v5h5v-2H7v-3zm12 5h-5v-2h3v-3h2v5zM7 7h3V5H5v5h2V7zm12 3h-2V5h-5v2h3v3h4z"
                      />
                    </svg>
                  ) : (
                    // enter icon
                    <svg viewBox="0 0 24 24" className="h-4 w-4">
                      <path
                        fill="currentColor"
                        d="M7 14H5v5h5v-2H7v-3zm12-9h-5v2h3v3h2V5zM7 7h3V5H5v5h2V7zm12 12h-3v2h5v-5h-2v3z"
                      />
                    </svg>
                  )}
                </button>
              </div>
            </div>
          </div>
        </div>
      </article>

      {growthMsg && (
        <Modal title="Progress updated" onClose={() => setGrowthMsg("")}>
          <p className="whitespace-pre-line text-sm text-slate-200 mb-4">
            {growthMsg}
          </p>
          <button
            onClick={() => setGrowthMsg("")}
            className="w-full rounded-xl bg-gradient-to-r from-emerald-600 via-emerald-500 to-sky-500 text-white py-2 text-sm font-medium"
          >
            Continue
          </button>
        </Modal>
      )}
    </div>
  );
}

================================================================================
FILE: app\components\Modal.js
================================================================================

"use client";
import { useEffect, useState } from "react";
import { createPortal } from "react-dom";

export default function Modal({ title, children, onClose }) {
  const [mounted, setMounted] = useState(false);

  // mount portal target
  useEffect(() => setMounted(true), []);

  // hard lock background scroll (mobile-safe) and preserve scroll position
  useEffect(() => {
    const body = document.body;
    const html = document.documentElement;
    const prevBodyOverflow = body.style.overflow;
    const prevHtmlOverflow = html.style.overflow;
    const prevBodyPosition = body.style.position;
    const prevBodyWidth = body.style.width;
    const scrollY = window.scrollY;

    body.style.overflow = "hidden";
    html.style.overflow = "hidden";
    body.style.position = "fixed";
    body.style.width = "100%";
    body.style.top = `-${scrollY}px`;

    return () => {
      body.style.overflow = prevBodyOverflow;
      html.style.overflow = prevHtmlOverflow;
      body.style.position = prevBodyPosition;
      body.style.width = prevBodyWidth;
      body.style.top = "";
      window.scrollTo(0, scrollY);
    };
  }, []);

  if (!mounted) return null;

  return createPortal(
    <div className="fixed inset-0 z-[10000]" role="dialog" aria-modal="true">
      {/* Backdrop */}
      <button
        aria-label="Close"
        onClick={onClose}
        className="absolute inset-0 bg-slate-950/70 backdrop-blur"
      />
      {/* Absolute-centered shell so it cannot drift with layout */}
      <div className="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[90%] max-w-sm">
        {/* Card (self-scrolls if tall) */}
        <div className="max-h-[85vh] overflow-auto rounded-3xl border border-slate-800/80 bg-slate-900/60 backdrop-blur-xl shadow-2xl p-5">
          {title && (
            <h3 className="text-lg font-semibold text-white mb-3">
              <span className="bg-gradient-to-r from-emerald-300 via-emerald-400 to-sky-400 bg-clip-text text-transparent">
                {title}
              </span>
            </h3>
          )}
          {children}
        </div>
      </div>
    </div>,
    document.body
  );
}

================================================================================
FILE: app\components\Splash.js
================================================================================

"use client";

export default function Splash({ show }) {
  return (
    <div
      className={[
        "fixed inset-0 z-50 flex items-center justify-center",
        "transition-all duration-700 ease-out",
        show
          ? "opacity-100 scale-100 pointer-events-auto"
          : "opacity-0 scale-95 pointer-events-none",
      ].join(" ")}
    >
      {/* Layered ambient gradients */}
      <div
        className={[
          "absolute inset-0",
          // emerald glow top-center + sky glow bottom-right
          "bg-[radial-gradient(60%_40%_at_50%_-10%,rgba(16,185,129,0.25),transparent_60%),",
          "radial-gradient(45%_35%_at_85%_110%,rgba(56,189,248,0.20),transparent_60%)]",
        ].join("")}
      />
      {/* Vignette */}
      <div className="absolute inset-0 bg-slate-950/80 backdrop-blur" />

      {/* Card */}
      <div className="relative w-[86%] max-w-sm">
        <div className="relative rounded-3xl border border-slate-800/70 bg-slate-900/60 backdrop-blur-xl shadow-2xl overflow-hidden">
          {/* Soft top highlight */}
          <div className="pointer-events-none absolute -top-24 left-1/2 -translate-x-1/2 h-48 w-72 rounded-full bg-emerald-400/10 blur-3xl" />

          {/* Logo mark */}
          <div className="flex items-center justify-center pt-7">
            <div className="relative h-14 w-14 rounded-2xl bg-slate-800/70 border border-slate-700/70 shadow-inner grid place-items-center">
              {/* Minimal dumbbell glyph */}
              <svg
                viewBox="0 0 24 24"
                className="h-6 w-6 text-slate-100"
                aria-hidden="true"
              >
                <path
                  fill="currentColor"
                  d="M4 9h2v6H4V9zm14 0h2v6h-2V9zM8 11h8v2H8v-2zM6 7h2v10H6V7zm10 0h2v10h-2V7z"
                />
              </svg>
              {/* subtle pulse ring */}
              <span className="absolute inset-0 rounded-2xl ring-1 ring-emerald-400/20 animate-pulse" />
            </div>
          </div>

          {/* Brand */}
          <div className="px-6 pb-7 pt-4 text-center">
            <h2 className="text-2xl font-extrabold leading-tight">
              <span className="bg-gradient-to-r from-emerald-300 via-emerald-400 to-sky-400 bg-clip-text text-transparent">
                Andy &amp; Petronela
              </span>
            </h2>
            <p className="mt-1 text-[13px] text-slate-400">
              Train â€¢ Track â€¢ Progress
            </p>

            {/* Progress sweep bar */}
            <div className="mt-5 h-1.5 w-full rounded-full bg-slate-800 overflow-hidden">
              <div
                className={[
                  "h-full w-1/3 rounded-full",
                  "bg-gradient-to-r from-emerald-400 via-emerald-300 to-sky-400",
                  "animate-[sweep_1.4s_ease-in-out_infinite]",
                ].join(" ")}
                style={{
                  // keyframes via inline style fallbacks
                  // Tailwind JIT handles arbitrary animations but we provide keyframes here:
                  animationName: "sweep",
                }}
              />
            </div>
          </div>
        </div>
      </div>

      {/* Inline keyframes (scoped) */}
      <style jsx>{`
        @keyframes sweep {
          0% {
            transform: translateX(-100%);
            width: 25%;
            opacity: 0.8;
          }
          50% {
            transform: translateX(20%);
            width: 55%;
            opacity: 1;
          }
          100% {
            transform: translateX(120%);
            width: 25%;
            opacity: 0.8;
          }
        }
      `}</style>
    </div>
  );
}

================================================================================
FILE: app\data\exercises.json
================================================================================

{
    "Monday": [],
    "Tuesday": [],
    "Wednesday": [
        {
            "title": "Warmup Wednesday",
            "description": "5â€“7 min light cardio + shoulder/elbow mobility.",
            "video": "Warmup Wednesday"
        },
        {
            "title": "Dumbbell Bench Press",
            "description": "Flat bench chest press â€” 3Ã—8.",
            "video": "Dumbbell Bench Press"
        },
        {
            "title": "Dumbbell Bench Flyes",
            "description": "On the flat bench; wide controlled arcs â€” 3Ã—8.",
            "video": "Dumbbell Bench Flyes"
        },
        {
            "title": "Dumbbell Skull Crushers",
            "description": "Flat bench; elbow stays vertical â€” 3Ã—8.",
            "video": "Dumbbell Skull Crushers"
        },
        {
            "title": "Overhead Dumbbell Triceps Extension",
            "description": "Standing single or double DB â€” 3Ã—8.",
            "video": "Overhead Dumbbell Triceps Extension"
        },
        {
            "title": "Bench Dips",
            "description": "Hands on bench, feet on floor â€” 3Ã—8.",
            "video": "Bench Dips"
        }
    ],
    "Thursday": [
        {
            "title": "Warmup Thursday",
            "description": "5â€“7 min light cardio + upper-back activation.",
            "video": "Warmup Thursday"
        },
        {
            "title": "One-Arm Dumbbell Row",
            "description": "Support on bench, row DB to hip â€” 3Ã—8/side.",
            "video": "One-Arm Dumbbell Row"
        },
        {
            "title": "Dumbbell Romanian Deadlift",
            "description": "Hinge at hips, neutral back â€” 3Ã—8.",
            "video": "Dumbbell Romanian Deadlift"
        },
        {
            "title": "Dumbbell Pullover",
            "description": "Flat bench; lats + chest; slow control â€” 3Ã—8.",
            "video": "Dumbbell Pullover"
        },
        {
            "title": "Dumbbell Reverse Fly",
            "description": "Hip hinge; raise to a T â€” 3Ã—8.",
            "video": "Dumbbell Reverse Fly"
        },
        {
            "title": "Dumbbell Hammer Curl",
            "description": "Neutral grip; squeeze â€” 3Ã—8.",
            "video": "Dumbbell Hammer Curl"
        }
    ],
    "Friday": [
        {
            "title": "Warmup Friday",
            "description": "5â€“7 min light cardio + shoulder circles/band pull-aparts.",
            "video": "Warmup Friday"
        },
        {
            "title": "Dumbbell Shoulder Press",
            "description": "Seating strict press â€” 3Ã—8.",
            "video": "Dumbbell Shoulder Press"
        },
        {
            "title": "Dumbbell Upright Row",
            "description": "DBs close; elbows lead â€” 3Ã—8.",
            "video": "Dumbbell Upright Row"
        },
        {
            "title": "Dumbbell Lateral Raise",
            "description": "Soft elbows; to shoulder height â€” 3Ã—8.",
            "video": "Dumbbell Lateral Raise"
        },
        {
            "title": "Rear Delt Row",
            "description": "Hip hinge; row toward ribs â€” 3Ã—8.",
            "video": "Rear Delt Row"
        },
        {
            "title": "Dumbbell Front Raise",
            "description": "Raise DBs in front to shoulder height â€” 3Ã—8.",
            "video": "Dumbbell Front Raise"
        }
    ],
    "Saturday": [
        {
            "title": "Warmup Saturday",
            "description": "5â€“7 min light cardio + core activation.",
            "video": "Warmup Saturday"
        },
        {
            "title": "Goblet Squat",
            "description": "Hold DB at chest; sit deep â€” 3Ã—8.",
            "video": "Goblet Squat"
        },
        {
            "title": "Push-Up",
            "description": "Body straight; chest to floor â€” 3Ã—8.",
            "video": "Push-Up"
        },
        {
            "title": "Dumbbell Hip Thrust",
            "description": "Upper back on bench; drive hips â€” 3Ã—8.",
            "video": "Dumbbell Hip Thrust"
        },
        {
            "title": "Crunches",
            "description": "Controlled floor crunches â€” 3Ã—8.",
            "video": "Crunches"
        },
        {
            "title": "Russian Twist",
            "description": "Lean back; twist side to side â€” 3Ã—8/side.",
            "video": "Russian Twist"
        }
    ],
    "Sunday": [
        {
            "title": "Warmup Sunday",
            "description": "5â€“7 min light cardio + hip/ankle mobility.",
            "video": "Warmup Sunday"
        },
        {
            "title": "Dumbbell Squat",
            "description": "DBs at sides or rack â€” 3Ã—8.",
            "video": "Dumbbell Squat"
        },
        {
            "title": "Dumbbell Reverse Lunge",
            "description": "Step back; front knee tracks toes â€” 3Ã—8/side.",
            "video": "Dumbbell Reverse Lunge"
        },
        {
            "title": "Dumbbell Romanian Deadlift (leg day)",
            "description": "Hamstrings focus; slow eccentric â€” 3Ã—8.",
            "video": "Dumbbell Romanian Deadlift (leg day)"
        },
        {
            "title": "Glute Bridge (Floor)",
            "description": "On floor; squeeze glutes at top â€” 3Ã—8.",
            "video": "Glute Bridge (Floor)"
        },
        {
            "title": "Standing Calf Raise",
            "description": "Full stretch and squeeze; hold DBs â€” 3Ã—8.",
            "video": "Standing Calf Raise"
        }
    ]
}
================================================================================
FILE: app\lib\connection.js
================================================================================

// Hardcoded connection (you asked to avoid .env/Vercel vars)
export const MONGODB_URI =
  "mongodb+srv://alexandruifrim92:Lolkola93@quickclose.vppnmtc.mongodb.net/?retryWrites=true&w=majority&appName=quickclose";

// DB / collection names
export const MONGODB_DB = "app";
export const MONGODB_COLLECTION = "fitness";

================================================================================
FILE: app\lib\mongo.js
================================================================================

import { MongoClient } from "mongodb";
import { MONGODB_URI, MONGODB_DB, MONGODB_COLLECTION } from "./connection";

let cached = global._mongo;
if (!cached) cached = global._mongo = { client: null, db: null, col: null };

export async function getCol() {
  if (!MONGODB_URI) throw new Error("No Mongo URI configured.");

  if (cached.col) return cached.col;

  const client = new MongoClient(MONGODB_URI);
  await client.connect();

  const db = client.db(MONGODB_DB);
  const col = db.collection(MONGODB_COLLECTION);

  cached.client = client;
  cached.db = db;
  cached.col = col;

  // Ensure the two base docs exist so upserts always work on empty collections
  await col.updateOne(
    { _id: "status" },
    { $setOnInsert: { status: {} } },
    { upsert: true }
  );
  await col.updateOne(
    { _id: "weights" },
    { $setOnInsert: { weights: {} } },
    { upsert: true }
  );

  return col;
}
